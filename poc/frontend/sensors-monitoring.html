<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="TC Agro Solutions - Sensor Monitoring" />
    <link rel="icon" type="image/svg+xml" href="./favicon.svg" />
    <title>Sensors | TC Agro Solutions</title>
    <link rel="stylesheet" href="./css/style.css" />
  </head>
  <body>
    <div class="app-container">
      <!-- Sidebar -->
      <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
          <span class="sidebar-logo">ğŸŒ¾</span>
          <span class="sidebar-brand">TC Agro</span>
        </div>

        <nav class="sidebar-nav">
          <div class="nav-section">
            <div class="nav-section-title">Main</div>
            <a href="dashboard.html" class="nav-item">
              <span class="nav-icon">ğŸ“Š</span>
              <span class="nav-text">Dashboard</span>
            </a>
            <a href="properties.html" class="nav-item">
              <span class="nav-icon">ğŸ˜ï¸</span>
              <span class="nav-text">Properties</span>
            </a>
            <a href="plots.html" class="nav-item">
              <span class="nav-icon">ğŸŒ±</span>
              <span class="nav-text">Plots</span>
            </a>
            <a href="sensors.html" class="nav-item">
              <span class="nav-icon">ğŸ“¡</span>
              <span class="nav-text">Sensors</span>
            </a>
            <a href="users.html" class="nav-item">
              <span class="nav-icon">ğŸ‘¥</span>
              <span class="nav-text">Users</span>
            </a>
          </div>

          <div class="nav-section">
            <div class="nav-section-title">Monitoring</div>
            <a href="sensors-monitoring.html" class="nav-item active">
              <span class="nav-icon">ğŸ“¡</span>
              <span class="nav-text">Sensors</span>
            </a>
            <a href="alerts.html" class="nav-item">
              <span class="nav-icon">ğŸ””</span>
              <span class="nav-text">Alerts</span>
            </a>
          </div>

          <div class="nav-section">
            <div class="nav-section-title">Account</div>
            <a href="#" class="nav-item" data-action="logout">
              <span class="nav-icon">ğŸšª</span>
              <span class="nav-text">Logout</span>
            </a>
          </div>
        </nav>
      </aside>

      <div id="sidebarOverlay" class="sidebar-overlay"></div>

      <!-- Main Content -->
      <main class="main-content">
        <header class="topbar">
          <div class="topbar-left">
            <button id="menuToggle" class="menu-toggle">â˜°</button>
            <h1 class="page-title">Sensors</h1>
          </div>
          <div class="topbar-right">
            <div class="user-menu">
              <div class="user-avatar">ğŸŒ¾</div>
              <span id="userDisplay" class="user-name">User</span>
            </div>
          </div>
        </header>

        <div class="content">
          <!-- Page Header -->
          <div class="page-header">
            <div class="page-header-title">
              <span class="page-header-icon">ğŸ“¡</span>
              <div>
                <div class="breadcrumb">
                  <a href="sensors-monitoring.html">Monitoring</a>
                  <span class="breadcrumb-separator">/</span>
                  <span>Sensors</span>
                </div>
                <h2 style="margin: 0">Sensor Monitoring</h2>
              </div>
            </div>
            <div class="page-header-actions">
              <span
                id="sensors-updating-indicator"
                class="text-muted"
                style="font-size: 0.85em; display: none"
              >
                Updated just now
              </span>
              <button id="refresh-sensors" class="btn btn-outline">âŸ³ Refresh</button>
            </div>
          </div>

          <!-- Status Summary Cards -->
          <div class="stats-grid" style="margin-bottom: 24px">
            <div class="stat-card">
              <div
                class="stat-icon"
                style="background: linear-gradient(135deg, #2d5016 0%, #4a7c2c 100%)"
              >
                ğŸ“¡
              </div>
              <div class="stat-info">
                <span id="stat-total-sensors" class="stat-value">0</span>
                <span class="stat-label">Total Sensors</span>
              </div>
            </div>
            <div class="stat-card">
              <div
                class="stat-icon"
                style="background: linear-gradient(135deg, #28a745 0%, #48c774 100%)"
              >
                âœ…
              </div>
              <div class="stat-info">
                <span id="stat-active-sensors" class="stat-value">0</span>
                <span class="stat-label">Active</span>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">âšª</div>
              <div class="stat-info">
                <span id="stat-inactive-sensors" class="stat-value">0</span>
                <span class="stat-label">Inactive</span>
              </div>
            </div>
            <div class="stat-card">
              <div
                class="stat-icon"
                style="background: linear-gradient(135deg, #ffc107 0%, #ffdd57 100%)"
              >
                âš ï¸
              </div>
              <div class="stat-info">
                <span id="stat-maintenance-sensors" class="stat-value">0</span>
                <span class="stat-label">Maintenance</span>
              </div>
            </div>
            <div class="stat-card">
              <div
                class="stat-icon"
                style="background: linear-gradient(135deg, #dc3545 0%, #f14668 100%)"
              >
                âŒ
              </div>
              <div class="stat-info">
                <span id="stat-faulty-sensors" class="stat-value">0</span>
                <span class="stat-label">Faulty</span>
              </div>
            </div>
          </div>

          <!-- Filters -->
          <div class="card" style="margin-bottom: 24px">
            <div class="form-row sensors-filters-row">
              <div class="form-group sensors-filter-grow" style="margin-bottom: 0">
                <input
                  type="text"
                  id="searchInput"
                  class="form-control"
                  placeholder="ğŸ” Search sensors..."
                />
              </div>
              <div class="form-group sensors-filter-grow" style="margin-bottom: 0">
                <select id="statusFilter" class="form-control form-select">
                  <option value="">All Status</option>
                </select>
              </div>
              <div class="form-group sensors-filter-grow" style="margin-bottom: 0">
                <select id="typeFilter" class="form-control form-select">
                  <option value="">All Types</option>
                </select>
              </div>
              <div class="form-group sensors-filter-actions" style="margin-bottom: 0">
                <button id="clear-alert-filters" class="btn btn-outline btn-sm" type="button">
                  âœ– Clear filters
                </button>
              </div>
            </div>
          </div>

          <!-- Sensors Grid -->
          <div class="sensor-grid" id="sensors-grid">
            <!-- Sensor Card 1 -->
            <div class="card sensor-card" data-status="Active">
              <div class="d-flex justify-between align-center" style="margin-bottom: 12px">
                <span class="badge badge-success">ğŸŸ¢ Active</span>
                <span class="text-muted" style="font-size: 0.85em">5 min ago</span>
              </div>
              <h3 style="margin: 0 0 4px 0">ğŸ“¡ SENSOR-001</h3>
              <p class="text-muted" style="margin: 0 0 16px 0; font-size: 0.9em">
                North Field â€¢ Green Valley Farm
              </p>
              <div class="sensor-readings">
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸŒ¡ï¸ Temperature</span>
                  <span class="sensor-reading-value">28.5Â°C</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸ’§ Humidity</span>
                  <span class="sensor-reading-value">65%</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸŒ± Soil Moisture</span>
                  <span class="sensor-reading-value">42%</span>
                </div>
              </div>
              <div style="margin-top: 16px">
                <button class="btn btn-outline btn-sm">ğŸ“Š View History</button>
              </div>
            </div>

            <!-- Sensor Card 2 -->
            <div class="card sensor-card" data-status="Active">
              <div class="d-flex justify-between align-center" style="margin-bottom: 12px">
                <span class="badge badge-success">ğŸŸ¢ Active</span>
                <span class="text-muted" style="font-size: 0.85em">5 min ago</span>
              </div>
              <h3 style="margin: 0 0 4px 0">ğŸ“¡ SENSOR-002</h3>
              <p class="text-muted" style="margin: 0 0 16px 0; font-size: 0.9em">
                South Valley â€¢ Green Valley Farm
              </p>
              <div class="sensor-readings">
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸŒ¡ï¸ Temperature</span>
                  <span class="sensor-reading-value">27.8Â°C</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸ’§ Humidity</span>
                  <span class="sensor-reading-value">68%</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸŒ± Soil Moisture</span>
                  <span class="sensor-reading-value">45%</span>
                </div>
              </div>
              <div style="margin-top: 16px">
                <button class="btn btn-outline btn-sm">ğŸ“Š View History</button>
              </div>
            </div>

            <!-- Sensor Card 3 - Maintenance -->
            <div
              class="card sensor-card"
              data-status="Maintenance"
              style="border-left: 4px solid #ffc107"
            >
              <div class="d-flex justify-between align-center" style="margin-bottom: 12px">
                <span class="badge badge-warning">ğŸŸ¡ Maintenance</span>
                <span class="text-muted" style="font-size: 0.85em">15 min ago</span>
              </div>
              <h3 style="margin: 0 0 4px 0">ğŸ“¡ SENSOR-003</h3>
              <p class="text-muted" style="margin: 0 0 16px 0; font-size: 0.9em">
                East Ridge â€¢ Sunrise Ranch
              </p>
              <div class="sensor-readings">
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸŒ¡ï¸ Temperature</span>
                  <span class="sensor-reading-value" style="color: #e67e22">36.2Â°C</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸ’§ Humidity</span>
                  <span class="sensor-reading-value">38%</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸŒ± Soil Moisture</span>
                  <span class="sensor-reading-value" style="color: #dc3545">22%</span>
                </div>
              </div>
              <div
                class="alert alert-warning"
                style="margin-top: 12px; padding: 8px 12px; font-size: 0.85em"
              >
                âš ï¸ Soil moisture below threshold (30%)
              </div>
              <div style="margin-top: 12px">
                <button class="btn btn-outline btn-sm">ğŸ“Š View History</button>
              </div>
            </div>

            <!-- Sensor Card 4 -->
            <div class="card sensor-card" data-status="Active">
              <div class="d-flex justify-between align-center" style="margin-bottom: 12px">
                <span class="badge badge-success">ğŸŸ¢ Active</span>
                <span class="text-muted" style="font-size: 0.85em">5 min ago</span>
              </div>
              <h3 style="margin: 0 0 4px 0">ğŸ“¡ SENSOR-004</h3>
              <p class="text-muted" style="margin: 0 0 16px 0; font-size: 0.9em">
                West Grove â€¢ Sunrise Ranch
              </p>
              <div class="sensor-readings">
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸŒ¡ï¸ Temperature</span>
                  <span class="sensor-reading-value">29.1Â°C</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸ’§ Humidity</span>
                  <span class="sensor-reading-value">62%</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸŒ± Soil Moisture</span>
                  <span class="sensor-reading-value">48%</span>
                </div>
              </div>
              <div style="margin-top: 16px">
                <button class="btn btn-outline btn-sm">ğŸ“Š View History</button>
              </div>
            </div>

            <!-- Sensor Card 5 - Faulty -->
            <div
              class="card sensor-card"
              data-status="Faulty"
              style="border-left: 4px solid #dc3545; opacity: 0.8"
            >
              <div class="d-flex justify-between align-center" style="margin-bottom: 12px">
                <span class="badge badge-danger">ğŸ”´ Faulty</span>
                <span class="text-muted" style="font-size: 0.85em">2 hours ago</span>
              </div>
              <h3 style="margin: 0 0 4px 0">ğŸ“¡ SENSOR-005</h3>
              <p class="text-muted" style="margin: 0 0 16px 0; font-size: 0.9em">
                Central Plain â€¢ Highland Estate
              </p>
              <div class="sensor-readings">
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸŒ¡ï¸ Temperature</span>
                  <span class="sensor-reading-value text-muted">--</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸ’§ Humidity</span>
                  <span class="sensor-reading-value text-muted">--</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸŒ± Soil Moisture</span>
                  <span class="sensor-reading-value text-muted">--</span>
                </div>
              </div>
              <div
                class="alert alert-danger"
                style="margin-top: 12px; padding: 8px 12px; font-size: 0.85em"
              >
                ğŸš¨ Sensor not responding. Check connection.
              </div>
              <div style="margin-top: 12px">
                <button class="btn btn-outline btn-sm">ğŸ“Š View History</button>
                <button class="btn btn-danger btn-sm">ğŸ”§ Diagnose</button>
              </div>
            </div>

            <!-- Sensor Card 6 - Maintenance (Battery Low) -->
            <div
              class="card sensor-card"
              data-status="Maintenance"
              style="border-left: 4px solid #ffc107"
            >
              <div class="d-flex justify-between align-center" style="margin-bottom: 12px">
                <span class="badge badge-warning">ğŸŸ¡ Maintenance</span>
                <span class="text-muted" style="font-size: 0.85em">10 min ago</span>
              </div>
              <h3 style="margin: 0 0 4px 0">ğŸ“¡ SENSOR-006</h3>
              <p class="text-muted" style="margin: 0 0 16px 0; font-size: 0.9em">
                Central Plain â€¢ Highland Estate
              </p>
              <div class="sensor-readings">
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸŒ¡ï¸ Temperature</span>
                  <span class="sensor-reading-value">30.4Â°C</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸ’§ Humidity</span>
                  <span class="sensor-reading-value">55%</span>
                </div>
                <div class="sensor-reading">
                  <span class="sensor-reading-label">ğŸ”‹ Battery</span>
                  <span class="sensor-reading-value" style="color: #e67e22">15%</span>
                </div>
              </div>
              <div
                class="alert alert-warning"
                style="margin-top: 12px; padding: 8px 12px; font-size: 0.85em"
              >
                ğŸ”‹ Battery critically low. Replace soon.
              </div>
              <div style="margin-top: 12px">
                <button class="btn btn-outline btn-sm">ğŸ“Š View History</button>
              </div>
            </div>
          </div>

          <div class="card pagination-sticky-card" style="margin-top: 16px; margin-bottom: 24px">
            <div class="d-flex justify-between align-center" style="flex-wrap: wrap; gap: 12px">
              <div class="d-flex align-center" style="gap: 8px">
                <button id="sensors-prev-page" class="btn btn-outline btn-sm" type="button">
                  â† Previous
                </button>
                <button id="sensors-next-page" class="btn btn-outline btn-sm" type="button">
                  Next â†’
                </button>
              </div>

              <span id="sensors-page-info" class="text-muted" style="font-size: 0.9em">
                Showing 0-0 of 0
              </span>

              <div class="d-flex align-center" style="gap: 8px">
                <label for="sensors-page-size" class="text-muted" style="font-size: 0.9em"
                  >Page size</label
                >
                <select id="sensors-page-size" class="form-control form-select" style="width: 140px">
                  <option value="5">5 / page</option>
                  <option value="10" selected>10 / page</option>
                  <option value="20">20 / page</option>
                  <option value="30">30 / page</option>
                  <option value="40">40 / page</option>
                  <option value="50">50 / page</option>
                  <option value="100">100 / page</option>
                </select>
              </div>
            </div>
          </div>

          <!-- SignalR Status -->
          <div class="card" style="margin-top: 24px">
            <div class="d-flex justify-between align-center" style="flex-wrap: wrap; gap: 16px">
              <div class="d-flex align-center gap-2">
                <span id="signalrStatus" class="badge badge-success">ğŸŸ¢ Live Updates Active</span>
                <span id="transport-mode-status" class="badge badge-info">SignalR</span>
                <span class="text-muted" style="font-size: 0.85em"
                  >Readings update every 5 seconds</span
                >
              </div>
              <span class="text-muted" style="font-size: 0.85em">
                Last sync: <span id="lastSync">Just now</span>
              </span>
            </div>
          </div>
        </div>
      </main>
    </div>

    <div id="sensor-status-modal" class="modal" aria-hidden="true">
      <div class="modal-content" style="max-width: 640px">
        <div class="modal-header">
          <h3>ğŸ”„ Change Sensor Status</h3>
          <button
            id="sensor-status-modal-close"
            type="button"
            class="modal-close"
            aria-label="Close sensor status dialog"
          >
            Ã—
          </button>
        </div>

        <form id="sensor-status-form">
          <div class="modal-body">
            <p id="sensor-status-summary" class="text-muted" style="margin-top: 0"></p>

            <div class="form-group">
              <label for="sensor-status-new-status" class="form-label">New status</label>
              <select id="sensor-status-new-status" class="form-control form-select" required>
                <option value="">Select status</option>
              </select>
            </div>

            <div class="form-group" style="margin-bottom: 0">
              <label for="sensor-status-reason" class="form-label">Reason (optional)</label>
              <textarea
                id="sensor-status-reason"
                class="form-control"
                rows="4"
                maxlength="500"
                placeholder="Describe why this status change is needed"
              ></textarea>
            </div>
          </div>

          <div class="modal-footer">
            <button id="sensor-status-cancel" type="button" class="btn btn-outline">Cancel</button>
            <button id="sensor-status-submit" type="submit" class="btn btn-primary">Save</button>
          </div>
        </form>
      </div>
    </div>

    <div id="sensor-history-modal" class="modal" aria-hidden="true">
      <div class="modal-content" style="max-width: 840px">
        <div class="modal-header">
          <h3>ğŸ“Š Sensor History</h3>
          <button
            id="sensor-history-modal-close"
            type="button"
            class="modal-close"
            aria-label="Close sensor history dialog"
          >
            Ã—
          </button>
        </div>
        <div class="modal-body">
          <p id="sensor-history-summary" class="text-muted" style="margin-top: 0"></p>
          <div class="d-flex justify-between align-center" style="gap: 12px; flex-wrap: wrap; margin-bottom: 12px">
            <div class="d-flex align-center" style="gap: 8px">
              <label for="sensor-history-days" class="text-muted" style="font-size: 0.9em">Period</label>
              <select id="sensor-history-days" class="form-control form-select" style="width: 140px">
                <option value="1">1 day</option>
                <option value="3">3 days</option>
                <option value="7" selected>7 days</option>
                <option value="15">15 days</option>
                <option value="30">30 days</option>
              </select>
            </div>
            <div class="d-flex align-center" style="gap: 8px">
              <label for="sensor-history-page-size" class="text-muted" style="font-size: 0.9em">Page size</label>
              <select id="sensor-history-page-size" class="form-control form-select" style="width: 120px">
                <option value="10">10</option>
                <option value="20" selected>20</option>
                <option value="50">50</option>
              </select>
            </div>
            <div class="d-flex align-center" style="gap: 8px">
              <label for="sensor-history-sort" class="text-muted" style="font-size: 0.9em">Date</label>
              <select id="sensor-history-sort" class="form-control form-select" style="width: 140px">
                <option value="desc" selected>Newest first</option>
                <option value="asc">Oldest first</option>
              </select>
            </div>
          </div>
          <div id="sensor-history-content"></div>
        </div>
        <div class="modal-footer">
          <span id="sensor-history-page-info" class="text-muted" style="font-size: 0.9em; margin-right: auto">Showing 0-0 of 0</span>
          <button id="sensor-history-prev" type="button" class="btn btn-outline btn-sm">â† Previous</button>
          <button id="sensor-history-next" type="button" class="btn btn-outline btn-sm">Next â†’</button>
          <button id="sensor-history-close" type="button" class="btn btn-outline">Close</button>
        </div>
      </div>
    </div>

    <style>
      /* Additional Sensor-specific Styles */
      .sensor-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 24px;
      }

      .sensor-card {
        transition:
          transform 0.2s ease,
          box-shadow 0.2s ease;
      }

      .sensor-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
      }

      .sensor-readings {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .sensor-reading {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: #f8f9fa;
        border-radius: 8px;
      }

      .sensor-reading-label {
        color: #666;
        font-size: 0.9em;
      }

      .sensor-reading-value {
        font-weight: 600;
        font-size: 1.1em;
        font-family: 'Consolas', 'Monaco', monospace;
      }

      .sensors-filters-row {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .sensors-filter-grow {
        flex: 1 1 0;
        min-width: 0;
      }

      .sensors-filter-actions {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        margin-left: auto;
      }

      .sensors-filter-actions .btn {
        white-space: nowrap;
      }

      @media (max-width: 768px) {
        .sensor-grid {
          grid-template-columns: 1fr;
        }

        .sensors-filters-row {
          flex-direction: column;
          align-items: stretch;
        }

        .sensors-filter-actions {
          margin-left: 0;
          justify-content: stretch;
        }

        .sensors-filter-actions .btn {
          width: 100%;
        }
      }
    </style>

    <!-- Scripts (ES Module) -->
    <script type="module" src="./js/sensors-monitoring.js"></script>
  </body>
</html>
