meta {
  name: Admin Login
  type: http
  seq: 1
}

post {
  url: {{identity_service_url}}/auth/login
  body: json
  auth: inherit
}

body:json {
  {
    "email": "Admin4@Admin.COM",
    "password": "Admin@123"
  }
}

script:post-response {
  const responseJson = res.getBody();
  const newToken = responseJson.jwtToken;
  
  if (newToken) {
      bru.setEnvVar("admin_token", newToken);
      console.log("✅ Token atualizado com sucesso!");
  } else {
      throw new Error("❌ Não foi possível extrair o token da resposta");
  }
  
  // Teste simples
  assert(newToken, "Token deve existir");
  assert(newToken.length > 0, "Token não pode ser vazio");
}

settings {
  encodeUrl: true
  timeout: 0
}
